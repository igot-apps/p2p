<!DOCTYPE html>
<html>
<head>
  <title>P2P Merchant Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 20px;
      color: #222;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    .card {
      background: #ffffff;
      padding: 18px;
      margin: 12px 0;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }

    input {
      padding: 8px;
      border-radius: 8px;
      border: 1px solid #ddd;
      margin: 5px;
      width: 110px;
    }

    button {
      padding: 8px 12px;
      border-radius: 8px;
      border: none;
      background: #16a34a;
      color: white;
      cursor: pointer;
    }

    button:hover {
      opacity: 0.9;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    th {
      background: #f0f2f5;
    }

    th, td {
      padding: 10px;
      border-bottom: 1px solid #eee;
      text-align: center;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 12px;
    }

    .box {
      background: #fafafa;
      padding: 14px;
      border-radius: 10px;
      text-align: center;
      border: 1px solid #eee;
    }

    .big {
      font-size: 18px;
      font-weight: bold;
      margin-top: 5px;
      color: #16a34a;
    }
  </style>
</head>
<body>

<h1>ðŸ“Š P2P Trading Dashboard</h1>

<div class="card">
  <h3>Add Buy Layer</h3>
  Price: <input type="number" id="price" step="0.01">
  Amount (USDT): <input type="number" id="amount">
  <button onclick="addLayer()">Add</button>
</div>

<div class="card">
  <h3>Profit Settings</h3>
  Target Profit %:
  <input type="number" id="profitPercent" value="0.5" step="0.1" onchange="calculate()">
</div>

<div class="card stats">
  <div class="box">
    Total USDT
    <div class="big" id="totalQty">0</div>
  </div>

  <div class="box">
    Total Cost
    <div class="big" id="totalCost">0</div>
  </div>

  <div class="box">
    Average Price
    <div class="big" id="avgPrice">0</div>
  </div>

  <div class="box">
    Suggested Sell
    <div class="big" id="sellPrice">0</div>
  </div>
</div>

<div class="card">
  <h3>Inventory Layers</h3>
  <table>
    <thead>
      <tr>
        <th>Price</th>
        <th>Amount</th>
        <th>Total</th>
        <th>Remove</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>
</div>

<script>
let layers = JSON.parse(localStorage.getItem("layers")) || [];

function save() {
  localStorage.setItem("layers", JSON.stringify(layers));
}

function addLayer() {
  let price = parseFloat(document.getElementById("price").value);
  let amount = parseFloat(document.getElementById("amount").value);

  if (!price || !amount) return;

  layers.push({ price, amount });
  save();
  render();
}

function removeLayer(index) {
  layers.splice(index, 1);
  save();
  render();
}

function render() {
  let body = document.getElementById("tableBody");
  body.innerHTML = "";

  layers.forEach((l, i) => {
    body.innerHTML += `
      <tr>
        <td>${l.price}</td>
        <td>${l.amount}</td>
        <td>${(l.price*l.amount).toFixed(2)}</td>
        <td><button onclick="removeLayer(${i})">X</button></td>
      </tr>
    `;
  });

  calculate();
}

function calculate() {
  let totalQty = 0;
  let totalCost = 0;

  layers.forEach(l => {
    totalQty += l.amount;
    totalCost += l.price * l.amount;
  });

  let avg = totalCost / totalQty || 0;
  let profitPercent = parseFloat(document.getElementById("profitPercent").value) || 0;
  let sell = avg * (1 + profitPercent/100);

  document.getElementById("totalQty").innerText = totalQty.toFixed(2);
  document.getElementById("totalCost").innerText = totalCost.toFixed(2);
  document.getElementById("avgPrice").innerText = avg.toFixed(4);
  document.getElementById("sellPrice").innerText = sell.toFixed(4);
}

render();
</script>

</body>
</html>
